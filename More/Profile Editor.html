<!doctypehtml><html lang="en"><meta http-equiv="Content-Type"content="text/html; charset=UTF-8"><title>Mod Selector Profile Editor</title><link rel="stylesheet"href="../HTML/css/font.css"><style>body{background:#d3d3d3;font-family:"Trebuchet MS";margin:0}#editor{margin-bottom:9.36px}.fullscreen-msg{display:flex;justify-content:center;position:fixed;left:0;bottom:0;right:0;top:0;transition:background .25s,color .25s;pointer-events:none;color:transparent}.fullscreen-msg.hovering{background:rgba(127,127,127,.5);color:#fff}.fullscreen-msg span{align-self:center;font-size:500%}label{pointer-events:all;cursor:pointer}div.title-container{background:#fff;margin-bottom:8px;margin:6px;padding:8px;min-width:317px}div.title{font-size:150%;padding-bottom:10px;border-bottom:gray 1px dashed}.hstack{justify-content:center;display:flex;align-items:center}.hstack{gap:30px}.hstack>.hstack{gap:3px}.explanation{font-size:70%}.expbox{height:20px;width:20px;border:1px solid;font-size:70%}.wbox{background-color:#fff}.rbox{background-color:#faa}.bbox{background-color:#8c8cff}div.header{display:flex;justify-content:space-around;font-size:125%;padding-top:10px}div.sections{padding-left:8px}h3.section{margin:0;margin-top:9.36px;padding-left:2px;color:#646464}h3.section u{cursor:pointer}h3.section.visible{padding-left:0}div.toggleMods{color:#646464;font-size:75%;margin-left:30px}div.mods{display:flex;flex-wrap:wrap;padding:3px;padding-left:0}.mod{display:flex;background:#fff;padding:3px;margin:3px;transition:background .4s;user-select:none;flex-grow:1;align-content:center;cursor:pointer;color:#000;text-decoration:none;position:relative}.mod>div{padding:5px}.mod.disabled{background:#ffc8c8}.mod.enabled{background:#aaf}.mod-id{color:gray;font-style:italic;font-size:60%}img.mod-icon{float:left;margin-right:10px;height:32px;width:32px;object-fit:none}div.mod-info{float:right}a.mod-delete{color:#fff;background:red;border-radius:5px;padding:1px 3px;border:1px solid #000;font-weight:700;line-height:1;font-size:85%;margin-left:auto;height:max-content}input[type=file]{display:none}input{font-family:inherit}button{color:inherit;border:inherit;font:inherit;text-align:inherit;background:inherit;padding:0}.clickable{font-size:inherit;color:#00e;cursor:pointer;text-decoration:underline}</style><script src="js/vue.min.js"></script><script src="js/vue-toastr-2.min.js"></script><link rel="stylesheet"href="css/vue-toastr-2.min.css"><script>var mods=[{name:"10x10 Casing (199 modules)",id:"10x10 Casing (199 modules)",type:"case"},{name:"11x11 Casing (241 modules)",id:"11x11 Casing (241 modules)",type:"case"},{name:"12x12 Casing (287 modules)",id:"12x12 Casing (287 modules)",type:"case"},{name:"13x13 Casing (337 modules)",id:"13x13 Casing (337 modules)",type:"case"},{name:"14x14 Casing (391 modules)",id:"14x14 Casing (391 modules)",type:"case"},{name:"15x15 Casing (449 modules)",id:"15x15 Casing (449 modules)",type:"case"},{name:"16x16 Casing (511 modules)",id:"16x16 Casing (511 modules)",type:"case"},{name:"17x17 Casing (577 modules)",id:"17x17 Casing (577 modules)",type:"case"},{name:"18x18 Casing (647 modules)",id:"18x18 Casing (647 modules)",type:"case"},{name:"19x19 Casing (721 modules)",id:"19x19 Casing (721 modules)",type:"case"},{name:"20x20 Casing (799 modules)",id:"20x20 Casing (799 modules)",type:"case"},{name:"21x21 Casing (881 modules)",id:"21x21 Casing (881 modules)",type:"case"},{name:"22x22 Casing (967 modules)",id:"22x22 Casing (967 modules)",type:"case"},{name:"2x2 Casing (7 modules)",id:"2x2 Casing (7 modules)",type:"case"},{name:"3x3 Casing (17 modules)",id:"3x3 Casing (17 modules)",type:"case"},{name:"4x4 Casing (31 modules)",id:"4x4 Casing (31 modules)",type:"case"},{name:"5x5 Casing (49 modules)",id:"5x5 Casing (49 modules)",type:"case"},{name:"6x6 Bomb Case",id:"6x6 Bomb Case",type:"case"},{name:"6x6 Casing (71 modules)",id:"6x6 Casing (71 modules)",type:"case"},{name:"7x7 Bomb Case",id:"7x7 Bomb Case",type:"case"},{name:"7x7 Casing (97 modules)",id:"7x7 Casing (97 modules)",type:"case"},{name:"8x8 Casing (127 modules)",id:"8x8 Casing (127 modules)",type:"case"},{name:"9x9 Casing (161 modules)",id:"9x9 Casing (161 modules)",type:"case"},{name:"Black Case",id:"Black Case",type:"case"},{name:"Black Double Decker",id:"Black Double Decker",type:"case"},{name:"Black Quadruple Decker",id:"Black Quadruple Decker",type:"case"},{name:"Blue Case",id:"Blue Case",type:"case"},{name:"Blue Double Decker",id:"Blue Double Decker",type:"case"},{name:"Blue Quadruple Decker",id:"Blue Quadruple Decker",type:"case"},{name:"Centurion",id:"Centurion",type:"case"},{name:"Cyan Case",id:"Cyan Case",type:"case"},{name:"Cyan Double Decker",id:"Cyan Double Decker",type:"case"},{name:"Cyan Quadruple Decker",id:"Cyan Quadruple Decker",type:"case"},{name:"Double Decker",id:"Double Decker Bomb",type:"case"},{name:"Glass Case",id:"Glass Case",type:"case"},{name:"Glass Double Decker",id:"Glass Double Decker",type:"case"},{name:"Glass Quadruple Decker",id:"Glass Quadruple Decker",type:"case"},{name:"Gold Case",id:"Gold Case",type:"case"},{name:"Gold Double Decker",id:"Gold Double Decker",type:"case"},{name:"Gold Quadruple Decker",id:"Gold Quadruple Decker",type:"case"},{name:"Gold Shine",id:"Gold Shine",type:"case"},{name:"Gold Shine  Quadruple Decker",id:"Gold Shine  Quadruple Decker",type:"case"},{name:"Gold Shine Double Decker",id:"Gold Shine Double Decker",type:"case"},{name:"Gray  Quadruple Decker",id:"Gray  Quadruple Decker",type:"case"},{name:"Gray Case",id:"Gray Case",type:"case"},{name:"Gray Double Decker",id:"Gray Double Decker",type:"case"},{name:"Green Case",id:"Green Case",type:"case"},{name:"Green Double Decker",id:"Green Double Decker",type:"case"},{name:"Green Quadruple Decker",id:"Green Quadruple Decker",type:"case"},{name:"Matrix Blue",id:"Matrix Blue",type:"case"},{name:"Matrix Green",id:"Matrix Green",type:"case"},{name:"Matrix Orange",id:"Matrix Orange",type:"case"},{name:"Matrix Pink",id:"Matrix Pink",type:"case"},{name:"Matrix Purple",id:"Matrix Purple",type:"case"},{name:"Matrix Red",id:"Matrix Red",type:"case"},{name:"Matrix Teal",id:"Matrix Teal",type:"case"},{name:"Matrix Yellow",id:"Matrix Yellow",type:"case"},{name:"Orange Case",id:"Orange Case",type:"case"},{name:"Orange Double Decker",id:"Orange Double Decker",type:"case"},{name:"Orange Quadruple Decker",id:"Orange Quadruple Decker",type:"case"},{name:"Pink Case",id:"Pink Case",type:"case"},{name:"Pink Double Decker",id:"Pink Double Decker",type:"case"},{name:"Pink Quadruple Decker",id:"Pink Quadruple Decker",type:"case"},{name:"Quadruple Decker",id:"Quadruple Decker",type:"case"},{name:"Red Case",id:"Red Case",type:"case"},{name:"Red Double Decker",id:"Red Double Decker",type:"case"},{name:"Red Quadruple Decker",id:"Red Quadruple Decker",type:"case"},{name:"White Case",id:"White Case",type:"case"},{name:"White Double Decker",id:"White Double Decker",type:"case"},{name:"White Quadruple Decker",id:"White Quadruple Decker",type:"case"},{name:"Wood Case",id:"Wood Case",type:"case"},{name:"Wood Double Decker",id:"Wood Double Decker",type:"case"},{name:"Wood Quadruple Decker",id:"Wood Quadruple Decker",type:"case"},{name:"Big Ring Case",id:"RingCaseBig",type:"case"},{name:"Small Ring Case",id:"RingCaseSmall",type:"case"},{name:"BetterCasePicker",id:"BetterCasePicker(Clone)",type:"service"},{name:"Camera Zoom",id:"CamZoom(Clone)",type:"service"},{name:"Competitive Server",id:"CompetitiveServer(Clone)",type:"service"},{name:"Date of Manufacture",id:"DayTimeMod(Clone)",type:"service"},{name:"Free Play Helper",id:"FreePlayHelper(Clone)",type:"service"},{name:"Rule Seed Modifier",id:"GenerateCustomManual(Clone)",type:"service"},{name:"Pacing Extender",id:"PacingExtender(Clone)",type:"service"},{name:"Soundpack Maker",id:"SoundpackMaker(Clone)",type:"service"},{name:"Tweaks",id:"Tweaks(Clone)",type:"service"},{name:"Widget Expander",id:"WidgetExpandService(Clone)",type:"service"},{name:"Bomb Corp Office",id:"BombCorpOffice",type:"Room"},{name:"The Bus That Couldn't Slow Down",id:"BusGameplayRoom",type:"Room"},{name:"Factory",id:"FactoryRoom",type:"Room"},{name:"Five Nights at Freddy's",id:"FNAFGameplayRoom",type:"Room"},{name:"Gameplay Room +",id:"TMPGameplayRoom",type:"Room"},{name:"Games Arcade",id:"ArcadeRoom",type:"Room"},{name:"Hypnosis",id:"ExampleGameplayRoom",type:"Room"},{name:"The Infinity Room",id:"Infinity Room",type:"Room"},{name:"Module Assembly Station",id:"moduleAssemblyStation",type:"Room"},{name:"Portal Gameplay Room",id:"Portal Room",type:"Room"},{name:"Subway Simulator",id:"TDSSubwayRoom",type:"Room"},{name:"SPAAAAAAAACE!!",id:"SpaceRoom",type:"Room"},{name:"Tutorial Gameplay Room",id:"TutorialGameplayRoom",type:"Room"}];const sortingMethods=[{Name:"Name",Compare:(e,a)=>e.SortKey>a.SortKey?1:-1},{Name:"Publish Date",Compare:(e,a)=>e.Published<a.Published?1:-1}],NumOps=3,OpExp=0,OpDef=1,OpComb=2,ModEither=2,ModYes=1,ModNo=0,vueData={profileName:void 0,operation:0,opExplain:["Expert: Enabled mods can show up on the bomb","Defuser: Disabled mods can't show up on the bomb","Combined: Used for filtering at bombs.samfun.dev"],mods:mods,modTypes:{Regular:"Solvable Modules",Needy:"Needy Modules",Widget:"Widgets",service:"Services",case:"Bomb Cases",Room:"Gameplay Rooms"},visibleTypes:{Regular:!0,Needy:!0},isHovering:!1,isRenaming:!1,sortingMethodIndex:0,sortingMethods:sortingMethods};class Mod{constructor(e,a,o,n,i,t="_"){this.Name=e,this.SortKey=a,this.Icon=o,this.ID=n,this.Type=i,this.Published=t,this.Enabled=1,this.Unknown=!1}}function makeRequest(e){return new Promise((function(a,o){const n=new XMLHttpRequest;n.open("GET",e),n.onload=function(){a(n.responseText)},n.onerror=function(){o(n.status)},n.send()}))}vueData.mods=mods.map((e=>new Mod(e.name,e.name.toUpperCase().replace(/^THE |[^0-9A-Z]/g,""),{X:0,Y:0},e.id,e.type,e.published))),makeRequest("https://ktane.timwi.de/json/raw").then((e=>{const a=JSON.parse(e);for(const e of vueData.mods){const o=e.Icon;if(0!==o.X||0!==o.Y)continue;const n=e.Name.replace(/ \((Translated|Russian|Polish|Español)\)$/,""),i=a.KtaneModules.filter((e=>e.Name==n));if(1===i.length){const e=i[0];o.X=e.X,o.Y=e.Y}}a.KtaneModules.forEach((function(e){e.ModuleID?(void 0===e.SortKey&&(e.SortKey=e.Name.toUpperCase().replace(/^THE /,"").replace(/[^A-Z0-9]/g,"")),"Mods"==e.Origin&&vueData.mods.push(new Mod(e.Name,e.SortKey,{X:e.X,Y:e.Y},e.ModuleID,e.Type,e.Published))):console.warn("Skipping "+e.Name+" because it lacks an ID.")}))})).catch((e=>console.error(`Failed to load JSON data! Error: ${e}`)));const devMode="file:"==window.location.protocol;function UMod(e,a){let o=Math.abs(a);return e-o*Math.floor(e/o)}Vue.config.devtools=devMode,window.onload=function(){var e=this.toastr;let a=new Vue({el:"#editor",data:vueData,methods:{toggleMod:function(e,a){2==this.operation?e.Enabled=UMod(e.Enabled-1,3):e.Enabled=1-e.Enabled,a&&a.preventDefault()},getJSON:function(){const e=1===this.operation?this.mods:this.mods.filter((e=>["Regular","Needy","Widget"].includes(e.Type))),a={DisabledList:e.filter((e=>0==e.Enabled)).map((e=>e.ID)),EnabledList:e.filter((e=>2===this.operation?1==e.Enabled:0!=e.Enabled)).map((e=>e.ID)),Operation:this.operation};return 1===this.operation&&delete a.EnabledList,JSON.stringify(a,null,2)},onFileUploaded:function(e){s(e.target.files)},startRenaming:function(){this.isRenaming=!0,setTimeout(function(){this.$refs.renameField.focus()}.bind(this),0)},handleRenaming:function(e){("keydown"==e.type&&"Enter"==e.key||"blur"==e.type)&&(this.isRenaming=!1,"keydown"==e.type&&e.target.blur())},switchOperation:function(){this.operation=(this.operation+1)%3,this.mods.forEach((e=>{2==this.operation?1==e.Enabled&&(e.Enabled=2):2==e.Enabled&&(e.Enabled=1)}))},handleDownload:function(e){if(null==this.profileName){const a=prompt("Enter a profile name to download the profile:");null!==a&&(this.profileName=a,Vue.nextTick((()=>e.target.click()))),e.preventDefault()}navigator.msSaveBlob&&(navigator.msSaveBlob(new Blob([this.getJSON()]),this.profileName+".json"),e.preventDefault())},getMods:n,toggleType:function(e){Vue.set(this.visibleTypes,e,!this.visibleTypes[e])},setAllMods:function(e,a){n(e).forEach((e=>{e.Enabled=a}))},toggleAllMods:function(e){n(e).forEach((e=>this.toggleMod(e)))},deleteMod:function(e){this.mods.splice(this.mods.indexOf(e),1)},deleteAllUnknown:function(){this.mods=this.mods.filter((e=>!e.Unknown))}}});function o(e){if(!e.moduleCount){var a={Centurion:101,Quadruple:47,Double:23,"Big Ring Case":81,"Small Ring Case":79},o=!1,n=e.Name;for(var i in a)if(n.includes(i)){e.moduleCount=a[i],o=!0;break}var t=n.match(/(\d+)x(\d+)/);t&&(e.moduleCount=parseInt(t[1])*parseInt(t[2])*2-1,o=!0),o||(e.moduleCount=11)}return e.moduleCount}function n(e){var a=vueData.mods.filter((a=>a.Type==e));const n=sortingMethods[vueData.sortingMethodIndex].Compare;return"case"==e?a.sort(((e,a)=>{var i=o(e),t=o(a);return i>t?1:i<t?-1:n(e,a)})):a.sort(n),a}function i(o,n){const i=function(e){try{return JSON.parse(e)}catch(e){return!1}}(o);if(!i)return e.error("Only valid JSON profiles are allowed","Profile Error"),!1;if(!Array.isArray(i.DisabledList)&&null!=i.DisabledList||"number"!=typeof i.Operation||!Array.isArray(i.EnabledList)&&null!=i.EnabledList)return e.error("Invalid profile detected","Profile Error"),!1;a.profileName=n.replace(/\.json$/,""),a.operation=i.Operation;const t=i.DisabledList,s=i.EnabledList||a.mods.filter((e=>!t.includes(e.ID))).map((e=>e.ID)),r=t.concat(s);for(const e of r){if(!a.mods.find((a=>a.ID==e))){const o=new Mod(e,e.toUpperCase(),{X:0,Y:0},e,"Regular");o.Unknown=!0,a.mods.push(o),console.warn("Can't find mod for "+e)}}for(const e of a.mods)t.includes(e.ID)&&s.includes(e.ID)?e.Enabled=1:t.includes(e.ID)||s.includes(e.ID)?e.Enabled=s.includes(e.ID)?1:0:e.Enabled=2==a.operation?2:0}function t(a){if(a.match(/^https?:\/\//)){let o=a.match(/[^/]+\.json$/);if(o)return makeRequest((devMode?"https://ktane.timwi.de":"")+"/proxy/"+a).then((function(e){i(e,o[0])})).catch((function(a){e.error("Unable to load profile from URL","HTTP Error"),console.error("HTTP Failure: "+a)})),!0}return!1}function s(o){if(1==o.length){var n=new FileReader;n.onload=function(){i(n.result,o[0].name)},n.readAsText(o[0])}else o.length>1?e.error("You can only import 1 file at a time","File Import Error"):e.error("Unable to find any imported files","File Import Error");a.isHovering=!1}window.addEventListener("dragover",(function(e){a.isHovering=!0,e.preventDefault()})),window.addEventListener("dragleave",(function(){a.isHovering=!1})),window.addEventListener("drop",(function(o){var n=o.dataTransfer.getData("Text");n?(a.isHovering=!1,t(n)||e.warning("Unable to read URL for profile.")):s(o.dataTransfer.files),o.preventDefault()})),window.addEventListener("paste",(function(a){var o="";window.clipboardData?o=window.clipboardData.getData("Text"):"object"==typeof a&&a.clipboardData&&(o=a.clipboardData.getData("text/plain")),t(o)||e.warning("Unable to read URL from paste.")}))}</script><div id="editor"><input id="file-upload"type="file"@change="onFileUploaded"><div class="fullscreen-msg":class="{ hovering: isHovering }"for="file-upload"><span>Drop profile!</span></div><div class="title-container"><div class="title hstack"><div class="hstack"><div class="expbox wbox"></div><span class="explanation">{{ operation==OpComb ? "Either":"Enabled" }}</span></div><div class="hstack"><div class="expbox rbox"></div><span class="explanation">{{ operation==OpComb ? "No":"Disabled" }}</span></div><div class="hstack"v-if="operation==OpComb"><div class="expbox bbox"></div><span class="explanation">Yes</span></div><span>Profile Editor</span> <span class="explanation">{{ opExplain[operation] }}</span></div><div class="header"><label class="clickable"for="file-upload"accesskey="i">Import</label><div v-if="!isRenaming"@click="startRenaming">{{ profileName ? `${profileName}.json` : "(Unnamed)" }} <button class="clickable"accesskey="r">Rename</button></div><input v-if="isRenaming"@keydown="handleRenaming"@blur="handleRenaming"@paste.stop v-model="profileName"ref="renameField"placeholder="Profile Name"><div>Type: <button class="clickable"@click="switchOperation"accesskey="o">{{ operation==OpComb ? "Combined" : operation==OpDef ? "Defuser" : "Expert" }}</button></div><div>Sort By: <button class="clickable"@click="sortingMethodIndex++; sortingMethodIndex %= sortingMethods.length;"accesskey="s">{{ sortingMethods[sortingMethodIndex].Name }}</button></div><div><a @click="handleDownload":download="profileName + '.json'":href="'data:application/json,' + encodeURIComponent(getJSON())":style="{ color: profileName == undefined ? 'gray' : null }":title="profileName == undefined ? 'Enter a profile name to download the profile.' : null"accesskey="d">Download</a></div></div></div><div class="sections"><template v-for="(name, type) in modTypes"><h3 class="section":class="{ visible: visibleTypes[type] }">{{ (visibleTypes[type] ? "▼ " : "▶ ") }}<button @click="toggleType(type)"><u>{{ name }}</u></button><span> ({{ getMods(type).filter(mod => operation==OpComb ? mod.Enabled != ModEither : operation==OpExp ? mod.Enabled!=ModNo : mod.Enabled==ModNo).length }}/{{ getMods(type).length }})</span></h3><div class="toggleMods"v-if="visibleTypes[type]"><button @click="setAllMods(type, ModYes)"class="clickable">Enable</button> / <button @click="setAllMods(type, ModNo)"class="clickable">Disable</button> <span v-if="operation == OpComb">/</span> <button v-if="operation == OpComb"@click="setAllMods(type, ModEither)"class="clickable">Either</button> / <button @click="toggleAllMods(type)"class="clickable">Toggle</button> All &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <button v-if="getMods(type).some(m => m.Unknown)"@click="deleteAllUnknown()"class="clickable">Remove All Unknown</button></div><div class="mods"v-if="visibleTypes[type]"><template v-for="mod in getMods(type)"><button @click="toggleMod(mod, $event)"class="mod":class="{ disabled: mod.Enabled==ModNo, enabled: operation==OpComb && mod.Enabled==ModYes }"><div><img v-if="['Regular', 'Needy', 'Widget'].includes(type)"class="mod-icon"src="https://ktane.timwi.de/iconsprite":style="{ 'object-position': `${mod.Icon.X * -32}px ${mod.Icon.Y * -32}px` }"><div class="mod-info"><div>{{ mod.Name }}</div><div class="mod-id">{{ mod.ID.replace(/\(Clone\)$/, "") }}</div></div></div><a class="mod-delete"v-if="mod.Unknown"@click="deleteMod(mod)"title="Unknown module. Delete?">✕</a></button></template></div></template></div></div>